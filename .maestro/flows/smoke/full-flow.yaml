# Full Flow Smoke Test
# Complete user journey: sign in -> view coach -> chat -> sign out
appId: com.coachcraft.app
tags:
  - smoke
---
- launchApp:
    clearState: true

# Sign in
- runFlow: ../auth/_sign-in-helper.yaml

# Verify coach list
- assertVisible:
    id: "coach-list"

# Select a prebuilt coach - use contains for partial match
- tapOn:
    text: "Max Flow"
    index: 0
- extendedWaitUntil:
    visible:
      id: "coach-name"
    timeout: 5000

# Start chat
- tapOn:
    id: "start-chat-button"
- extendedWaitUntil:
    visible:
      id: "chat-input"
    timeout: 5000

# Send a message
- tapOn:
    id: "chat-input"
- inputText: "Smoke test message"
- tapOn:
    id: "chat-send-button"

# Verify message was sent
- extendedWaitUntil:
    visible: "Smoke test message"
    timeout: 5000

# Navigate back to coach detail
- back
- extendedWaitUntil:
    visible:
      id: "coach-name"
    timeout: 3000

# Navigate back to coach list
- back
- extendedWaitUntil:
    visible:
      id: "coach-list"
    timeout: 3000

# Sign out via profile tab
- tapOn: "Profile"
- scrollUntilVisible:
    element:
      id: "sign-out-button"
    direction: DOWN
- tapOn:
    id: "sign-out-button"
# Alert button - text selector required
- tapOn: "Sign Out"
- extendedWaitUntil:
    visible:
      id: "sign-in-email"
    timeout: 5000
